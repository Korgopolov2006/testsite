{% extends 'paint_shop_project/base.html' %}
{% load static %}

{% block title %}–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ - –ñ–µ–≤–∂–∏–∫{% endblock %}

{% block extra_css %}
<style>
    .analytics-hero {
        background: linear-gradient(135deg, var(--zhevzhik-pink), var(--zhevzhik-light-pink));
        color: white;
        padding: 50px 0;
        text-align: center;
        margin-bottom: 40px;
    }
    
    .stat-card {
        background: white;
        border-radius: 15px;
        padding: 25px;
        box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        transition: all 0.3s ease;
        margin-bottom: 30px;
        text-align: center;
    }
    
    .stat-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 30px rgba(0,0,0,0.15);
    }
    
    .stat-number {
        font-size: 2.5rem;
        font-weight: bold;
        color: var(--zhevzhik-pink);
        margin-bottom: 10px;
    }
    
    .stat-label {
        color: var(--zhevzhik-dark-gray);
        font-weight: 600;
        margin-bottom: 5px;
    }
    
    .stat-description {
        color: var(--zhevzhik-gray);
        font-size: 0.9rem;
    }
    
    .chart-container {
        background: white;
        border-radius: 15px;
        padding: 25px;
        box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        margin-bottom: 30px;
    }
    
    .chart-title {
        color: var(--zhevzhik-pink);
        font-weight: 600;
        margin-bottom: 20px;
        display: flex;
        align-items: center;
    }
    
    .chart-title i {
        margin-right: 10px;
    }
    
    .table-analytics {
        background: white;
        border-radius: 15px;
        overflow: hidden;
        box-shadow: 0 5px 20px rgba(0,0,0,0.1);
    }
    
    .table-analytics th {
        background: var(--zhevzhik-light-pink);
        color: var(--zhevzhik-dark-pink);
        border: none;
        font-weight: 600;
    }
    
    .table-analytics td {
        border: none;
        border-bottom: 1px solid #f8f9fa;
    }
    
    .badge-status {
        padding: 5px 12px;
        border-radius: 15px;
        font-size: 0.8rem;
        font-weight: 600;
    }
    
    .badge-created { background: #17a2b8; color: white; }
    .badge-confirmed { background: #ffc107; color: black; }
    .badge-ready { background: #28a745; color: white; }
    .badge-delivered { background: #6f42c1; color: white; }
    .badge-cancelled { background: #dc3545; color: white; }
</style>
{% endblock %}

{% block content %}
<!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ -->
<div class="analytics-hero">
    <div class="container">
        <h1 class="display-4 mb-3">üìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞</h1>
        <p class="lead">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –æ—Ç—á–µ—Ç—ã –ø–æ —Ä–∞–±–æ—Ç–µ –º–∞–≥–∞–∑–∏–Ω–∞</p>
    </div>
</div>

<div class="container">
    <!-- –û—Å–Ω–æ–≤–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
    <div class="row mb-5">
        <div class="col-12">
            <h2 class="chart-title">
                <i class="fas fa-chart-line"></i>–û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
            </h2>
        </div>
    </div>
    
    <div class="row">
        <div class="col-lg-3 col-md-6 mb-4">
            <div class="stat-card">
                <div class="stat-number">{{ total_users }}</div>
                <div class="stat-label">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                <div class="stat-description">–í—Å–µ–≥–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–æ</div>
            </div>
        </div>
        
        <div class="col-lg-3 col-md-6 mb-4">
            <div class="stat-card">
                <div class="stat-number">{{ total_products }}</div>
                <div class="stat-label">–¢–æ–≤–∞—Ä–æ–≤</div>
                <div class="stat-description">–í –∫–∞—Ç–∞–ª–æ–≥–µ</div>
            </div>
        </div>
        
        <div class="col-lg-3 col-md-6 mb-4">
            <div class="stat-card">
                <div class="stat-number">{{ total_orders }}</div>
                <div class="stat-label">–ó–∞–∫–∞–∑–æ–≤</div>
                <div class="stat-description">–í—Å–µ–≥–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω–æ</div>
            </div>
        </div>
        
        <div class="col-lg-3 col-md-6 mb-4">
            <div class="stat-card">
                <div class="stat-number">{{ total_revenue|floatformat:0 }} ‚ÇΩ</div>
                <div class="stat-label">–í—ã—Ä—É—á–∫–∞</div>
                <div class="stat-description">–û–±—â–∞—è —Å—É–º–º–∞</div>
            </div>
        </div>
    </div>
    
    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ 30 –¥–Ω–µ–π -->
    <div class="row mb-5">
        <div class="col-12">
            <h2 class="chart-title">
                <i class="fas fa-calendar-alt"></i>–ó–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π
            </h2>
        </div>
    </div>
    
    <div class="row">
        <div class="col-lg-4 col-md-6 mb-4">
            <div class="stat-card">
                <div class="stat-number">{{ recent_revenue|floatformat:0 }} ‚ÇΩ</div>
                <div class="stat-label">–í—ã—Ä—É—á–∫–∞</div>
                <div class="stat-description">–ó–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –º–µ—Å—è—Ü</div>
            </div>
        </div>
        
        <div class="col-lg-4 col-md-6 mb-4">
            <div class="stat-card">
                <div class="stat-number">{{ recent_users }}</div>
                <div class="stat-label">–ù–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                <div class="stat-description">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª–æ—Å—å</div>
            </div>
        </div>
        
        <div class="col-lg-4 col-md-6 mb-4">
            <div class="stat-card">
                <div class="stat-number">{{ active_users }}</div>
                <div class="stat-label">–ê–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                <div class="stat-description">–ó–∞—Ö–æ–¥–∏–ª–∏ –≤ —Å–∏—Å—Ç–µ–º—É</div>
            </div>
        </div>
    </div>
    
    <!-- –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã -->
    <div class="row mb-5">
        <div class="col-12">
            <div class="chart-container">
                <h3 class="chart-title">
                    <i class="fas fa-star"></i>–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã
                </h3>
                <div class="table-responsive">
                    <table class="table table-analytics">
                        <thead>
                            <tr>
                                <th>–¢–æ–≤–∞—Ä</th>
                                <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                                <th>–¶–µ–Ω–∞</th>
                                <th>–ó–∞–∫–∞–∑–æ–≤</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for product in popular_products %}
                            <tr>
                                <td>{{ product.name }}</td>
                                <td>{{ product.category.name }}</td>
                                <td>{{ product.price }} ‚ÇΩ</td>
                                <td>{{ product.order_count }}</td>
                            </tr>
                            {% empty %}
                            <tr>
                                <td colspan="4" class="text-center text-muted">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    
    <!-- –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ -->
    <div class="row mb-5">
        <div class="col-12">
            <div class="chart-container">
                <h3 class="chart-title">
                    <i class="fas fa-tags"></i>–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
                </h3>
                <div class="table-responsive">
                    <table class="table table-analytics">
                        <thead>
                            <tr>
                                <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                                <th>–¢–æ–≤–∞—Ä–æ–≤</th>
                                <th>–ó–∞–∫–∞–∑–æ–≤</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for category in popular_categories %}
                            <tr>
                                <td>{{ category.name }}</td>
                                <td>{{ category.product_count }}</td>
                                <td>{{ category.order_count }}</td>
                            </tr>
                            {% empty %}
                            <tr>
                                <td colspan="3" class="text-center text-muted">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    
    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º –∑–∞–∫–∞–∑–æ–≤ -->
    <div class="row mb-5">
        <div class="col-12">
            <div class="chart-container">
                <h3 class="chart-title">
                    <i class="fas fa-chart-pie"></i>–°—Ç–∞—Ç—É—Å—ã –∑–∞–∫–∞–∑–æ–≤
                </h3>
                <div class="row">
                    {% for status in order_statuses %}
                    <div class="col-lg-2 col-md-4 col-sm-6 mb-3">
                        <div class="stat-card">
                            <div class="stat-number">{{ status.count }}</div>
                            <div class="stat-label">{{ status.status }}</div>
                        </div>
                    </div>
                    {% empty %}
                    <div class="col-12 text-center text-muted">
                        <p>–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ –∑–∞–∫–∞–∑–∞—Ö</p>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
    
    <!-- –ü—Ä–∏–∑—ã–≤ –∫ –¥–µ–π—Å—Ç–≤–∏—é -->
    <div class="row">
        <div class="col-12">
            <div class="card bg-gradient" style="background: linear-gradient(135deg, var(--zhevzhik-pink), var(--zhevzhik-light-pink)); color: white;">
                <div class="card-body text-center py-5">
                    <h2 class="mb-3">üê∑ –£–ø—Ä–∞–≤–ª—è–π—Ç–µ —Å–≤–æ–∏–º –º–∞–≥–∞–∑–∏–Ω–æ–º!</h2>
                    <p class="lead mb-4">–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∞–Ω–∞–ª–∏—Ç–∏–∫—É –¥–ª—è –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π</p>
                    <div class="row">
                        <div class="col-md-4 mb-3">
                            <a href="/admin/" class="btn btn-light btn-lg w-100">
                                <i class="fas fa-cog me-2"></i>–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
                            </a>
                        </div>
                        <div class="col-md-4 mb-3">
                            <a href="{% url 'product_list' %}" class="btn btn-light btn-lg w-100">
                                <i class="fas fa-shopping-bag me-2"></i>–ö–∞—Ç–∞–ª–æ–≥
                            </a>
                        </div>
                        <div class="col-md-4 mb-3">
                            <a href="{% url 'order_history' %}" class="btn btn-light btn-lg w-100">
                                <i class="fas fa-list me-2"></i>–ó–∞–∫–∞–∑—ã
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
