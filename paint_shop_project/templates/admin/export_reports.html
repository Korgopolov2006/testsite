{% extends "admin/base_site.html" %}
{% load i18n %}

{% block title %}{{ title }} | {% trans "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ Django" %}{% endblock %}

{% block extrastyle %}
<style>
    .export-container { padding-bottom:40px; }
    .export-header { display:flex; flex-wrap:wrap; gap:18px; align-items:center; justify-content:space-between; margin-bottom:32px; }
    .export-card { background:var(--card-bg, #fff); border-radius:12px; padding:24px; box-shadow:0 12px 30px rgba(0,0,0,0.05); margin-bottom:24px; color:var(--text-color, #1a2a6c); }
    .export-card h3 { margin-top:0; color:var(--text-color, #1a2a6c); }
    .export-form { display:grid; gap:16px; }
    .form-group { display:flex; flex-direction:column; gap:8px; }
    .form-group label { font-weight:600; color:var(--text-color, #1a2a6c); }
    .export-card input[type="number"],
    .export-card input[type="date"],
    .export-card select {
        background-color: var(--input-bg, #fff) !important;
        color: var(--text-color, #1a2a6c) !important;
        border-color: var(--border-color, #d0d7de) !important;
    }
</style>
{% endblock %}

{% block content %}
<div class="export-container">
    <div class="export-header">
        <div>
            <h1>{{ title }}</h1>
            <p class="help">{% trans "–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –≤ Excel –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞" %}</p>
        </div>
        <a href="{% url 'admin:index' %}" class="button">‚Üê {% trans "–í–µ—Ä–Ω—É—Ç—å—Å—è" %}</a>
    </div>

    <div class="export-card">
        <h3>{% trans "–û—Ç—á–µ—Ç –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º" %}</h3>
        <form method="post" class="export-form">
            {% csrf_token %}
            <input type="hidden" name="report_type" value="sales">
            <div class="form-group">
                <label>{% trans "–ü–µ—Ä–∏–æ–¥ (–¥–Ω–µ–π)" %}</label>
                <input type="number" name="days" value="30" min="1" max="365" required>
            </div>
            <button type="submit" class="button default">{% trans "üìä –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ Excel" %}</button>
        </form>
    </div>

    <div class="export-card">
        <h3>{% trans "–û—Ç—á–µ—Ç –ø–æ –∑–∞–∫–∞–∑–∞–º" %}</h3>
        <form method="post" class="export-form">
            {% csrf_token %}
            <input type="hidden" name="report_type" value="orders">
            <div class="form-group">
                <label>{% trans "–ü–µ—Ä–∏–æ–¥ (–¥–Ω–µ–π)" %}</label>
                <input type="number" name="days" value="30" min="1" max="365" required>
            </div>
            <button type="submit" class="button default">{% trans "üìä –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ Excel" %}</button>
        </form>
    </div>

    <div class="export-card">
        <h3>{% trans "–û—Ç—á–µ—Ç –ø–æ —Ç–æ–≤–∞—Ä–∞–º" %}</h3>
        <form method="post" class="export-form">
            {% csrf_token %}
            <input type="hidden" name="report_type" value="products">
            <div class="form-group">
                <label>{% trans "–ü–µ—Ä–∏–æ–¥ (–¥–Ω–µ–π)" %}</label>
                <input type="number" name="days" value="30" min="1" max="365" required>
            </div>
            <button type="submit" class="button default">{% trans "üìä –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ Excel" %}</button>
        </form>
    </div>

    <div class="export-card">
        <h3>{% trans "–û—Ç—á–µ—Ç –ø–æ –∫–ª–∏–µ–Ω—Ç–∞–º" %}</h3>
        <form method="post" class="export-form">
            {% csrf_token %}
            <input type="hidden" name="report_type" value="customers">
            <div class="form-group">
                <label>{% trans "–ü–µ—Ä–∏–æ–¥ (–¥–Ω–µ–π)" %}</label>
                <input type="number" name="days" value="30" min="1" max="365" required>
            </div>
            <button type="submit" class="button default">{% trans "üìä –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ Excel" %}</button>
        </form>
    </div>

    <h2 style="margin-top: 40px; margin-bottom: 20px;">{% trans "üìä –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –æ—Ç—á–µ—Ç—ã" %}</h2>

    <div class="export-card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
        <h3 style="color: white;">{% trans "üìÑ –ü–æ–ª–Ω—ã–π –æ—Ç—á–µ—Ç –¥–∞—à–±–æ—Ä–¥–∞ –≤ PDF" %}</h3>
        <p style="color: rgba(255,255,255,0.9);">{% trans "–≠–∫—Å–ø–æ—Ä—Ç –≤—Å–µ—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤ –¥–∞—à–±–æ—Ä–¥–∞ –≤ PDF: –≤—ã—Ä—É—á–∫–∞ –ø–æ –¥–Ω—è–º, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤, —Å—Ç–∞—Ç—É—Å—ã –∑–∞–∫–∞–∑–æ–≤, —Ç–æ–ø-10 —Ç–æ–≤–∞—Ä–æ–≤" %}</p>
        <form method="post" class="export-form">
            {% csrf_token %}
            <input type="hidden" name="report_type" value="dashboard_pdf">
            <div class="form-group">
                <label style="color: white;">{% trans "–ü–µ—Ä–∏–æ–¥ (–¥–Ω–µ–π)" %}</label>
                <input type="number" name="period" value="30" min="1" max="365" required>
            </div>
            <button type="submit" class="button" style="background: white; color: #667eea; font-weight: bold;">{% trans "üìÑ –°–∫–∞—á–∞—Ç—å PDF –æ—Ç—á–µ—Ç" %}</button>
        </form>
    </div>

    <div class="export-card" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white;">
        <h3 style="color: white;">{% trans "üìä –≠–∫—Å–ø–æ—Ä—Ç –≤—Å–µ—Ö –º–µ—Ç—Ä–∏–∫" %}</h3>
        <p style="color: rgba(255,255,255,0.9);">{% trans "–≠–∫—Å–ø–æ—Ä—Ç –≤—Å–µ—Ö –º–µ—Ç—Ä–∏–∫ –≤ –æ–¥–∏–Ω Excel —Ñ–∞–π–ª: –ø—Ä–æ–¥–∞–∂–∏, —Ç–æ–≤–∞—Ä—ã, –∫–ª–∏–µ–Ω—Ç—ã" %}</p>
        <form method="post" class="export-form">
            {% csrf_token %}
            <input type="hidden" name="report_type" value="all_metrics_export">
            <div class="form-group">
                <label style="color: white;">{% trans "–ü–µ—Ä–∏–æ–¥ (–¥–Ω–µ–π)" %}</label>
                <input type="number" name="days" value="30" min="1" max="365" required>
            </div>
            <button type="submit" class="button" style="background: white; color: #f5576c; font-weight: bold;">{% trans "üìä –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –º–µ—Ç—Ä–∏–∫–∏" %}</button>
        </form>
    </div>

    <h2 style="margin-top: 40px; margin-bottom: 20px;">{% trans "üì¶ –û—Ç—á–µ—Ç—ã –ø–æ –ø–∞—Ä—Ç–∏—è–º —Ç–æ–≤–∞—Ä–æ–≤" %}</h2>

    <div class="export-card">
        <h3>{% trans "–ü–∞—Ä—Ç–∏–∏, –∏—Å—Ç–µ–∫–∞—é—â–∏–µ –≤ –ø–µ—Ä–∏–æ–¥" %}</h3>
        <form method="post" class="export-form">
            {% csrf_token %}
            <input type="hidden" name="report_type" value="batches_expiring">
            <div class="form-group">
                <label>{% trans "–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞" %}</label>
                <input type="date" name="start_date" value="{{ today|date:'Y-m-d' }}" required>
            </div>
            <div class="form-group">
                <label>{% trans "–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è" %}</label>
                <input type="date" name="end_date" value="{{ next_month|date:'Y-m-d' }}" required>
            </div>
            <button type="submit" class="button default">{% trans "üìä –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ Excel" %}</button>
        </form>
    </div>

    <div class="export-card">
        <h3>{% trans "–ò—Å—Ç–æ—Ä–∏—è –¥–≤–∏–∂–µ–Ω–∏–π –ø–æ –ø–∞—Ä—Ç–∏—è–º" %}</h3>
        <form method="post" class="export-form">
            {% csrf_token %}
            <input type="hidden" name="report_type" value="batches_history">
            <div class="form-group">
                <label>{% trans "–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞" %}</label>
                <input type="date" name="start_date" value="{{ last_month|date:'Y-m-d' }}" required>
            </div>
            <div class="form-group">
                <label>{% trans "–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è" %}</label>
                <input type="date" name="end_date" value="{{ today|date:'Y-m-d' }}" required>
            </div>
            <button type="submit" class="button default">{% trans "üìä –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ Excel" %}</button>
        </form>
    </div>

    <div class="export-card">
        <h3>{% trans "–ê–Ω–∞–ª–∏–∑ –ø–æ—Ç–µ—Ä—å –æ—Ç –ø—Ä–æ—Å—Ä–æ—á–∫–∏" %}</h3>
        <form method="post" class="export-form">
            {% csrf_token %}
            <input type="hidden" name="report_type" value="batches_losses">
            <div class="form-group">
                <label>{% trans "–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞" %}</label>
                <input type="date" name="start_date" value="{{ last_month|date:'Y-m-d' }}" required>
            </div>
            <div class="form-group">
                <label>{% trans "–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è" %}</label>
                <input type="date" name="end_date" value="{{ today|date:'Y-m-d' }}" required>
            </div>
            <button type="submit" class="button default">{% trans "üìä –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ Excel" %}</button>
        </form>
    </div>

    <div class="export-card">
        <h3>{% trans "–û—Å—Ç–∞—Ç–∫–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º" %}</h3>
        <form method="post" class="export-form">
            {% csrf_token %}
            <input type="hidden" name="report_type" value="batches_by_category">
            <button type="submit" class="button default">{% trans "üìä –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ Excel" %}</button>
        </form>
    </div>

    <h2 style="margin-top: 40px; margin-bottom: 20px;">{% trans "üé® –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã" %}</h2>

    <div class="export-card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
        <h3 style="color: white;">{% trans "üìÑ –≠–∫—Å–ø–æ—Ä—Ç CSS —Å—Ç–∏–ª–µ–π" %}</h3>
        <p style="color: rgba(255,255,255,0.9);">{% trans "–°–∫–∞—á–∞–π—Ç–µ CSS —Ñ–∞–π–ª —Å–æ –≤—Å–µ–º–∏ —Å—Ç–∏–ª—è–º–∏, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–º–∏ –≤ Excel –∏ PDF —ç–∫—Å–ø–æ—Ä—Ç–∞—Ö. –ü–æ–ª–µ–∑–Ω–æ –¥–ª—è –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏–∏ –∏ –ø–æ–Ω–∏–º–∞–Ω–∏—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è." %}</p>
        <form method="post" class="export-form">
            {% csrf_token %}
            <input type="hidden" name="report_type" value="export_styles">
            <button type="submit" class="button" style="background: white; color: #667eea; font-weight: bold;">{% trans "üìÑ –°–∫–∞—á–∞—Ç—å CSS —Å—Ç–∏–ª–∏" %}</button>
        </form>
    </div>
</div>
{% endblock %}

